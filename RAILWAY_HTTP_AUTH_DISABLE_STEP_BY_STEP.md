# Railway HTTP認証を無効化する手順（完全公開モード）

## 🔴 問題

RailwayにデプロイしたCMSにアクセスすると、HTTP認証のログインダイアログが表示されます。

これはRailwayのHTTP認証機能が有効になっているためです。完全公開モードにするには、この機能を無効化する必要があります。

## ✅ 解決方法

### ステップ1: Railwayダッシュボードにアクセス

1. https://railway.app にアクセス
2. ログイン
3. プロジェクトを選択

### ステップ2: フロントエンドサービスの設定を開く

1. プロジェクト内で**フロントエンドサービス**を選択
2. **Settings**タブをクリック

### ステップ3: HTTP認証を無効化

1. **Settings**タブで下にスクロール
2. **Networking**セクションを探す
3. **HTTP Authentication**セクションを確認
4. **Disable**ボタンをクリック（またはトグルをオフにする）

### ステップ4: 環境変数を削除

1. **Variables**タブをクリック
2. 以下の環境変数が存在する場合は削除：
   - `RAILWAY_HTTP_AUTH_USERNAME`
   - `RAILWAY_HTTP_AUTH_PASSWORD`
   - `RAILWAY_HTTP_AUTH_ENABLED`
   - その他`HTTP_AUTH`関連の環境変数

### ステップ5: API Gatewayサービスの設定も確認

フロントエンドだけでなく、**API Gatewayサービス**でも同様の設定を確認：

1. **API Gatewayサービス**を選択
2. **Settings**タブ → **Networking**セクション
3. **HTTP Authentication**を無効化
4. **Variables**タブでHTTP認証関連の環境変数を削除

### ステップ6: サービスを再デプロイ（必要に応じて）

設定を変更した後、サービスが自動的に再デプロイされる場合もありますが、手動で再デプロイする場合：

1. **Deployments**タブをクリック
2. **Redeploy**ボタンをクリック（最新のデプロイメントを選択して）

### ステップ7: ブラウザで確認

1. ブラウザのキャッシュをクリア
   - `Ctrl+Shift+Delete` → キャッシュをクリア
   - または、シークレット/プライベートモードで開く

2. フロントエンドのURLに再度アクセス
   - HTTP認証のダイアログが表示されないことを確認
   - 通常のログイン画面（アプリケーションのログイン画面）が表示されることを確認

## 📸 画面の見分け方

### HTTP認証のログイン画面（無効化が必要）
- ブラウザのネイティブダイアログ
- 「ユーザー名」と「パスワード」の2つのフィールドのみ
- アプリケーションのデザインが適用されていない
- URLの前に鍵アイコンが表示される場合がある

### アプリケーションのログイン画面（正常）
- アプリケーションのデザインが適用されている
- メールアドレスとパスワードのフィールド
- アプリケーションのロゴやスタイリングが表示される

## 🆘 トラブルシューティング

### HTTP認証が無効化できない場合

1. **Railwayのプランを確認**
   - 無料プランでもHTTP認証の無効化は可能です
   - プロプランにアップグレードする必要はありません

2. **設定が保存されない場合**
   - ブラウザをリフレッシュ
   - 別のブラウザで試す
   - Railwayのダッシュボードを再読み込み

3. **環境変数を削除できない場合**
   - 環境変数の右側にある**削除アイコン**（ゴミ箱アイコン）をクリック
   - または、環境変数の値を空にして保存

### 再デプロイ後もHTTP認証が表示される場合

1. **ブラウザのキャッシュを完全にクリア**
   - 開発者ツール（F12）を開く
   - 「Network」タブで「Disable cache」にチェック
   - ページをリロード

2. **シークレット/プライベートモードで確認**
   - 新しいシークレット/プライベートウィンドウで開く
   - これによりキャッシュの影響を排除

3. **すべてのサービスの設定を確認**
   - フロントエンドだけでなく、API Gatewayも確認
   - 他のサービスでもHTTP認証が有効になっていないか確認

### 環境変数が自動的に再作成される場合

1. **Railwayの設定を確認**
   - プロジェクトレベルでHTTP認証が有効になっていないか確認
   - プロジェクトの**Settings**も確認

2. **GitHub ActionsやCI/CDを確認**
   - 自動デプロイの設定で環境変数が設定されていないか確認

## 📝 確認チェックリスト

- [ ] フロントエンドサービスのHTTP認証を無効化した
- [ ] API GatewayサービスのHTTP認証を無効化した
- [ ] HTTP認証関連の環境変数を削除した
- [ ] サービスを再デプロイした（必要に応じて）
- [ ] ブラウザのキャッシュをクリアした
- [ ] フロントエンドのURLに再度アクセスした
- [ ] HTTP認証のダイアログが表示されないことを確認した
- [ ] アプリケーションのログイン画面が表示されることを確認した

## 🎯 まとめ

1. **Railwayダッシュボード**で各サービスの**Settings**を開く
2. **Networking**セクションで**HTTP Authentication**を無効化
3. **Variables**タブでHTTP認証関連の環境変数を削除
4. **ブラウザのキャッシュをクリア**して再度アクセス

これらの手順を完了すれば、HTTP認証のダイアログが表示されなくなり、完全公開モードでアクセスできるようになります。

